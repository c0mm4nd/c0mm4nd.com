<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 5.4.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"c0mm4nd.com","root":"/","scheme":"Muse","version":"7.8.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":true,"show_result":false,"style":null},"back2top":{"enable":true,"sidebar":false,"scrollpercent":false},"bookmark":{"enable":true,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":true,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},"path":"search.xml"};
  </script>

  <meta name="description" content="使用机器学习与深度学习对恶意加密货币挖矿软件加密连接的检测简介： 如今，恶意软件已成为一个流行问题。在利用受害者计算机资源的攻击中，一种常见的攻击与数字货币加密所需的大量计算资源有关。网络犯罪分子从受害者那里窃取计算机资源，将这些资源与他们从中受益的加密货币矿池相关联。这项研究工作的重点是提供一种解决方案，仅通过被动网络监控来检测此类滥用的加密货币挖矿活动。为此，我们确定了一组新的高度相关的网络流">
<meta property="og:type" content="article">
<meta property="og:title" content="Detection of Encrypted Cryptomining Malware Connections With Machine and Deep Learning">
<meta property="og:url" content="https://c0mm4nd.com/post/detection-of-encrypted-cryptomining-malware-conn-with-ml-and-dl/index.html">
<meta property="og:site_name" content="Talkless">
<meta property="og:description" content="使用机器学习与深度学习对恶意加密货币挖矿软件加密连接的检测简介： 如今，恶意软件已成为一个流行问题。在利用受害者计算机资源的攻击中，一种常见的攻击与数字货币加密所需的大量计算资源有关。网络犯罪分子从受害者那里窃取计算机资源，将这些资源与他们从中受益的加密货币矿池相关联。这项研究工作的重点是提供一种解决方案，仅通过被动网络监控来检测此类滥用的加密货币挖矿活动。为此，我们确定了一组新的高度相关的网络流">
<meta property="og:locale" content="en_US">
<meta property="article:published_time" content="2021-11-03T08:44:25.000Z">
<meta property="article:modified_time" content="2021-11-09T06:21:39.893Z">
<meta property="article:author" content="Command M (C0MM4ND&#x2F;K0MM4ND)">
<meta name="twitter:card" content="summary">

<link rel="canonical" href="https://c0mm4nd.com/post/detection-of-encrypted-cryptomining-malware-conn-with-ml-and-dl/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : false,
    isPost : true,
    lang   : 'en'
  };
</script>

  <title>Detection of Encrypted Cryptomining Malware Connections With Machine and Deep Learning | Talkless</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="Toggle navigation bar">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">Talkless</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>Home</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>Archives<span class="badge">55</span></a>

  </li>
        <li class="menu-item menu-item-about">

    <a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>About</a>

  </li>
        <li class="menu-item menu-item-tags">

    <a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>Tags<span class="badge">64</span></a>

  </li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>Search
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup">
        <div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocapitalize="off"
           placeholder="Searching..." spellcheck="false"
           type="search" class="search-input">
  </div>
  <span class="popup-btn-close">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div id="search-result">
  <div id="no-result">
    <i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>
  </div>
</div>

    </div>
  </div>

</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>
  <div class="reading-progress-bar"></div>
  <a role="button" class="book-mark-link book-mark-link-fixed"></a>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content post posts-expand">
            

    
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="https://c0mm4nd.com/post/detection-of-encrypted-cryptomining-malware-conn-with-ml-and-dl/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Command M (C0MM4ND/K0MM4ND)">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Talkless">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          Detection of Encrypted Cryptomining Malware Connections With Machine and Deep Learning
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2021-11-03 16:44:25" itemprop="dateCreated datePublished" datetime="2021-11-03T16:44:25+08:00">2021-11-03</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2021-11-09 14:21:39" itemprop="dateModified" datetime="2021-11-09T14:21:39+08:00">2021-11-09</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
        <h1 id="使用机器学习与深度学习对恶意加密货币挖矿软件加密连接的检测"><a href="#使用机器学习与深度学习对恶意加密货币挖矿软件加密连接的检测" class="headerlink" title="使用机器学习与深度学习对恶意加密货币挖矿软件加密连接的检测"></a>使用机器学习与深度学习对恶意加密货币挖矿软件加密连接的检测</h1><p>简介：</p>
<p>如今，恶意软件已成为一个流行问题。在利用受害者计算机资源的攻击中，一种常见的攻击与数字货币加密所需的大量计算资源有关。网络犯罪分子从受害者那里窃取计算机资源，将这些资源与他们从中受益的加密货币矿池相关联。这项研究工作的重点是提供一种解决方案，仅通过被动网络监控来检测此类滥用的加密货币挖矿活动。为此，我们确定了一组新的高度相关的网络流特征，与一组丰富的机器和深度学习模型联合使用，用于实时加密挖掘流检测。我们为训练和测试机器和深度学习模型部署了一个复杂而真实的加密挖掘场景，其中客户端与互联网上的真实服务器交互并使用加密连接。进行了一组完整的实验以证明，将这些信息量丰富的特征与复杂的机器学习模型相结合，即使流量被加密，也可以在线路上以电信级的精度和准确度检测到加密攻击。</p>
<p><strong>索引术语</strong>： 加密挖矿检测、恶意软件检测、加密劫持检测、加密货币挖掘、网络流量测量、加密流量分类、机器学习、深度学习。</p>
<h2 id="一、引言"><a href="#一、引言" class="headerlink" title="一、引言"></a>一、引言</h2><p>恶意软件是基于一个简单概念的流行问题：利用受害者的计算机资源。纵观最近的历史，恶意软件的演变提供了更大的弹性和多功能性来实现多个目标：拒绝服务 (DoS)、敏感数据盗窃、他人之间非法活动的匿名性。但总的来说，主要动机是经济。恶意软件家族开发了各种各样的技术来获利，从简单的 DoS 威胁勒索到复杂的银行木马，期望最终获得一些信托资金。在这种不可阻挡的演变 [1] 中，网络犯罪分子寻找新模式以获取快速利润。数字货币非常适合这种策略。</p>
<p>比特币 [2] 是第一个基于区块链的去中心化数字货币。任何拥有足够计算能力的人都可以参与并获利，进行加密计算来为区块链做出贡献。作为这种计算的结果，使用完全相同的加密货币提供了可变奖励。这通常被称为加密挖掘。不幸的是，独立的加密货币挖矿不再有利可图，解决方案是使用称为挖矿池的新型服务关联多台计算机（或机器人）。这些安排提供了与参与者使用特定协议提供的计算资源成比例的挖矿奖励的百分比（参见第 III 节）。如今，多种加密货币已经诞生和消亡[3]，为挖矿提供了多种有利可图的生态系统。确切地说，作为这种生态系统扩散的一部分，一些加密货币产生了对专用硬件 (ASIC) 设备的反对，改变了算法 [4]、[5] 使它们变得无用，并再次打开了通过正常计算机挖掘获利的机会。</p>
<p>网络犯罪分子可以通过两种主要方法填充他们的加密货币钱包。 首先，通过利用勒索软件恶意软件家族来加密受害者的数据并使用无法追踪的加密货币接收付款，以便让受害者恢复加密信息。 第二种选择包括使用僵尸网络或在浏览器中执行非法进程（加密劫持），在未经受害者同意的情况下，将受害者的计算机资源秘密添加到抗 ASIC 的矿池中，并为犯罪分子的利益花费计算资源。 第一个具有引起当局关注的内在风险，取决于受害者的支付意愿，但也带来了准时的大好处。 相反，第二种方法可以长时间运行，产生不断增加的收益 [6]。</p>
<p>我们研究的重点是<strong>第二种方法</strong>，它为行业提供了一种检测网络上的加密挖矿活动的解决方案。 挖矿流量通常被加密以避免检测，僵尸网络可以使用私有代理 IP 来聚合和伪装挖矿池。</p>
<p>众所周知，如今越来越多的流量被加密（&gt; 80%），因为许多网络协议（例如 TLS、SSH、QUIC、VPN）都采用了加密。此外，关注隐私问题的政府正在对电信提供商访问用户数据或检查数据包有效载荷施加限制。在这种情况下，我们提出了一种新的方法来检测网络上的加密挖掘活动（图 1），即使它是加密的，基于通过机器和深度学习技术分析挖掘客户端的网络行为，而不是经典的深度数据包和有效载荷检查技术或矿池域名识别。我们建议应用受监督的机器和深度学习技术，这些技术将排除使用 IP 地址、端口号或应用程序级别信息等可能包含个人和敏感用户数据的输入特征。此外，在机器学习模型的训练和测试阶段，加密流量将被广泛使用，因为这种类型的流量将在不久的将来变得普遍。</p>
<p>由于多种原因，我们选择门罗币（XMR）作为本研究的加密货币挖矿协议。首先，Monero 是迄今为止地下市场网络犯罪分子最喜欢的加密货币 [6]。其次，Monero 开发人员公开承诺将 ASIC 排除在挖矿生态系统之外，并且所需的资源量很少（例如 RandomX 算法 [5] 中的轻型模式，只需要 256 MiB 的共享内存），增加了恶意软件对其的采用家庭。最后，门罗币对 CPU 挖掘的偏好使得在 GPU 或 ASIC 设备方面对标准客户端的实验更加现实。我们在一个受控但现实的环境中证明，仔细的特征选择对于在存在加密货币流的交通场景中使用机器和深度学习模型获得良好的检测性能至关重要。我们使用从网络流量低点获得的两组不同的统计特征来比较机器学习性能。第一组是使用 Tstat 工具提取的，这是一种众所周知的被动嗅探器，能够在网络和传输级别提供每个流的统计信息，第二组来自 IETF 标准 NetFlow/IPFIX 指标，这些指标在行业中广泛使用.据我们所知，我们的研究工作是第一个利用 Tstat 获得的特征作为监督机器学习算法的输入的提议。我们证明了第一组比第二组提供了更多的信息，这意味着，独立于所使用的机器学习模型，预测更稳定、准确和精确。此外，我们表明复杂模型（例如随机森林和完全连接的深度神经网络）能够以比简单模型（例如决策树和逻辑回归）显着更高的精度、准确度和稳定性来检测加密流量活动，即使流量是加密。最后，我们得出结论，如本文中提出的那样，复杂的机器学习模型使用 Tstat 获得的一组详尽特征作为输入，以工业部署所需的准确度、精确度和稳定性识别加密货币流量。</p>
<h2 id="二、贡献"><a href="#二、贡献" class="headerlink" title="二、贡献"></a>二、贡献</h2><p>通过网络检测加密挖掘恶意软件仍处于起步阶段，据我们所知，只有一项研究工作 [7] 解决了这个问题，但假设了一个相当不切实际的场景，其中 i) 不考虑加密流量, ii) 只提出了一组简化的传统机器学习模型，并且 iii) 一组稍微没有信息的特征被用作输入。因此，当在我们的受控环境中重现实验时，获得的性能与电信行业的预期相差甚远。为了超越当前提案的局限性，我们的实验工作提出了以下新颖性：</p>
<p>• 一个复杂而真实的挖矿场景，用于训练和测试用于挖矿流检测的机器学习模型。该场景由典型的 Internet 应用程序（例如 Web 浏览、多媒体、通过共享文件夹访问文件）和与分布在 Internet 上的真实挖矿服务器池交互的加密客户端组成。这种受控设置允许生成真实的网络流量，即使流量被加密，也可以 100% 的精度自动收集和标记。标记的流量将用于训练和测试机器学习模型，用于满足电信行业严格要求的加密货币流检测。我们的实验设置与现有作品的一个显着特征是除了非加密连接之外还使用加密连接。如今，越来越多的应用程序对其通信进行加密，其内容的识别对机器学习分类器，尤其是密码挖掘检测器提出了额外的挑战。</p>
<p>• 提议将一组新的信息丰富的特征用作实时密码挖掘流检测的输入。这些功能源自 Tstat 生成的一组取证统计数据，该工具旨在从网络数据包跟踪中生成每个连接的统计数据。我们修改了 Tstat 工具以导出一组实时流特征，以输入到 ML 分类器以进行密码挖掘检测。在我们的实验中，我们证明了当网络流量被加密时，与使用标准特征相比，使用提议的新特征集显着提高了 ML 性能。</p>
<p>• 一套完整的实验表明，即使流量被加密，也可以使用派生的 Tstat 特征和复杂的机器学习模型，以电信级的精度和准确度在线路上检测到加密攻击</p>
<h2 id="三、加密货币和加密挖掘协议"><a href="#三、加密货币和加密挖掘协议" class="headerlink" title="三、加密货币和加密挖掘协议"></a>三、加密货币和加密挖掘协议</h2><p>加密货币可以定义为数字交换媒体，基于使用加密原语来规范新加密货币单位的发行和验证交易。中本聪 [2] 在开创性论文中介绍了第一个也是最广泛使用的加密货币比特币 (BTC)。加密货币是完全去中心化的，没有控制权，这是 P2P 文件共享网络的共同特征。交易的验证基于分布式账本，通过区块链（一种不可变的共享数据结构 [8]）实现。当使用加密货币时，相关交易被添加到区块链中。然后，加密货币用户（称为矿工）可以通过计算密集型加密过程（通常称为挖矿）验证新区块，即一组交易，以防止不公平地使用加密货币（例如双重支出）。鼓励矿工通过奖励（即新的加密货币单位）参与交易验证。然而，验证过程的高度复杂性使得获得此类奖励仅适用于专用硬件 (ASIC) 所有者。矿池试图克服这一限制，协调不同矿工的工作和资源，他们通过网络共享计算能力。用于在矿池参与者之间分配挖矿过程的最广泛协议称为 Stratum [9]，并且已首先用于 Slushpool 矿池 [10]。</p>
<p>图 2 所示的 Stratum 协议指定了矿池服务器与其参与者之间的双向通信通道，消息编码遵循 JSON-RPC 2.0 规范 [11]。下面，我们将简要描述典型的 Stratum 协议流程。首先，客户端可以发起（或恢复）与矿池服务器的会话，调用服务器上的订阅RPC方法，在请求中指定客户端将使用的挖矿软件来解决服务器随后将发送给的挑战客户端。需要注意的是，一个矿池用户在挖矿过程中可能会使用多个设备（Stratum 术语中的工人）。因此，客户端还需要授权服务器向每个工人发送挑战，通过为每个工人调用服务器上的授权 RPC 方法，将其用户名和密码发送到服务器（图 2 中的步骤 1）。然后，服务器可以向工作人员发送挑战，向他们调用提交 RPC 方法（图 2 中的步骤 2）。如果工作人员找到了挖矿挑战的解决方案，他可以通过调用提交 RPC 方法将其发送到服务器（图 2 中的步骤 3）。在验证解决方案的正确性后，服务器可以向解决挑战的工作人员以及其他试图解决问题的工作人员发送新的挑战，再次调用他们的提交 RPC 方法。 Stratum 消息可以以加密形式发送，例如将它们嵌入到 TLS 帧中 [12]。</p>
<h2 id="四、-相关工作"><a href="#四、-相关工作" class="headerlink" title="四、 相关工作"></a>四、 相关工作</h2><p>尽管是当今工业场景中的热门话题，但在当前的科学文献中，对加密采矿活动的检测却鲜有研究。 大多数当前最先进的工作主要集中在通过分析目标节点的行为来检测在受害者身上运行的加密挖掘或加密劫持软件模块。 尝试检测 Stratum 或其他加密挖矿协议的作品更少。</p>
<h3 id="A-加密流量的识别"><a href="#A-加密流量的识别" class="headerlink" title="A. 加密流量的识别"></a>A. 加密流量的识别</h3><p>很少有研究工作专注于通过查看网络流量来检测密码挖掘活动。与我们的研究最接近的工作是由 Muñoz 等人提出的。在 [7]。在这项工作中，作者评估了四种不同的机器学习技术（SVM、朴素贝叶斯、CART 和 C4.5 决策树），以识别应用非 DPI（深度数据包检测）方法的非加密加密矿层流。他们得出的结论是，可以识别用于挖掘五种不同加密货币（比特币、比特币现金、DogeCoin、莱特币和门罗币）的非加密 Stratum 连接。此外，作者表明，一些机器学习模型（例如 CART 决策树）能够准确地区分这些加密货币挖掘流与正常流量，并对正在挖掘的加密货币进行分类。我们研究与这项工作的主要区别在于（a）我们提出了更复杂的模型（随机森林和完全连接的神经网络）来检测加密活动，这显着提高了预测的稳定性、精度和准确性，（b）相反与 Muñoz 等人的方法相比，我们的研究中还考虑了加密流量，以评估现实场景中的机器学习性能，并且 (c) 我们使用了由 Tstat 工具派生的 51 个特征的更多信息集，这些特征产生了明显更好的效果结果比 Muñoz 等人采用的方法要好。仅利用来自 NetFlow/IPFIX 指标的 8 个功能。在我们设置的现实场景中比较这两个提议的结果，可以观察到，使用具有 Netflow 特征的更简单的机器学习算法，如 [7]，在机器学习预测中会产生不稳定和较差的性能。另一方面，当复杂的机器学习模型与更多信息特征结合使用时，如我们工作中提出的那样，可以获得高性能、稳健和稳定的预测。</p>
<p>斯威丹等人。 [13] 提出了一组更传统的方法来检测并最终阻止加密挖掘连接。 作者提出了一种名为 MDPS（挖矿检测和预防系统）的架构，用于丢弃由浏览器（例如 CoinHive、Crypto-Loot）生成的非加密挖矿流。 他们的方法基于部署代理，对连接执行 DPI 检查以拒绝任何可疑流量，当矿工加密他们的通信时，这是相当无效的。</p>
<h3 id="B-加密软件模块的识别"><a href="#B-加密软件模块的识别" class="headerlink" title="B. 加密软件模块的识别"></a>B. 加密软件模块的识别</h3><p>检测加密挖矿进程的大部分工作都使用安装在主机上（通常在浏览器内）的某种监控代理，该代理持续监控系统资源，并在检测到一些奇怪的行为时做出反应。</p>
<p>在 Konoth 等人的工作中。 [14]，作者提出了一种方法，能够通过静态分析网页中的 WebAssembly 代码来检测浏览器内的加密活动。密码挖掘基于计算多个散列值，并且这些函数具有特殊的模式（例如，长序列的 XOR 指令或使用各种加密原语函数），可以通过分析汇编操作码找到这些模式。作者提出了 MineSweeper，该组件可以分析网页加载的所有 WebAssembly 指令，并在模式分析显示加载了潜在的加密矿工时做出相应反应。代码的分析不是由机器学习技术执行的，但作者手动调查了最常见的浏览器中的矿工，并在他们的工具中硬编码了他们的模式。</p>
<p>卡林等人。 [15] 使用动态方法来检测浏览器中的加密矿工。他们的方法利用通过调试器 (OllyDbg) 启动浏览器 (FireFox) 收集的跟踪（发送到 CPU 的指令列表）。然后对这些跟踪中指令的操作码进行计数，然后将此整数向量用作随机森林分类器的输入特征。他们的机器学习模型经过训练能够区分：加密脚本、停用的加密脚本（没有开始挖掘函数调用的文件）、规范脚本（不是与加密相关的文件）和规范注入脚本（规范脚本的武器化版本，但注入了一些加密挖掘脚本）。他们的方法能够在每个类别上获得近 100% 的准确率。</p>
<p>刘等人。 [16] 修改了 Chrome 浏览器的内核，以包含名为 BMDetector 的矿工检测组件。该组件分析浏览器的堆内存和堆栈跟踪，并将它们发送到 LSTM（长短期内存）循环神经网络，该网络执行两类的实际分类：挖掘和非挖掘脚本。</p>
<p>Kharraz 等人也考虑了其他机器学习模型。 [17] 通过分析浏览器行为来识别加密劫持网站。他们的监控代理 Outguard 不断检查浏览器加载和执行的脚本，计算简单的数字特征并将它们发送到经过训练的机器学习模型以检测加密脚本。它们的功能包括脚本使用了多少并行任务、是否请求了 WebAssembly 或创建了多少 WebSocket。他们测试了随机森林和 SVM（支持向量机），并通过实验发现 SVM 获得了最好的结果。</p>
<h2 id="五、问题设定"><a href="#五、问题设定" class="headerlink" title="五、问题设定"></a>五、问题设定</h2><p>受害者通常不会将此类攻击视为问题，主要是因为没有直接的经济损失或赎金。识别加密货币开采时产生的流量（在所谓的加密挖掘过程中）对公司和最终用户都有用。首先，公司可能有兴趣检测在其公司网络上交换的层加密信息，因为他们可以指出一个或多个员工正在使用公司资源（例如公司拥有的设备、电力）来挖掘加密货币，从而获得非法经济收益损害公司财务。第二种情况是关于加密劫持的令人担忧的威胁，它危及最终用户和公司。网络犯罪分子正在了解加密挖掘的经济潜力，因此，他们传播恶意软件，在成功感染目标设备后，隐藏在受害者设备上运行的加密挖掘过程。加密挖掘，尤其是在不受限制的情况下，可能对最终用户设备的性能、移动设备的电池持续时间极为不利，并可能导致此类设备的使用寿命缩短。此外，加密劫持相关流量的识别可用作受监控设备的入侵指标 (IoC)，即使负责的恶意软件尚未包含在反恶意软件应用程序数据库中。</p>
<p>因此，基于网络流量分析检测和阻止加密挖矿活动可以消除以前对 IT 资源的影响，并阻止使用非法加密通信。首先，因为无法进行通信，挖矿过程停止消耗资源。其次，因为如果无法使用网络订购或收集计算交易，则不会产生奖励。</p>
<p>为了准确和精确地检测网络上不同类型的挖矿活动，我们提出了一个受控的网络环境，使用真实的客户端和服务器来生成与正常流量（网上冲浪、视频和音频流、云存储、文件传输、电子邮件和 P2P 等）通过专用网络并通过住宅宽带接入共享互联网连接。正常流量客户端与位于专用网络和 Internet 中的服务器交互。 Cryptomining 客户端连接到 Internet 中的真实矿池。作为迄今为止网络犯罪分子最喜欢的加密货币，门罗币被选为我们实验的加密货币。选择了两个不同的 Monero 客户端来提供 Stratum 协议的实现多样性，这是迄今为止最广泛用于在矿池之间分配挖矿过程的协议。客户端虚拟机中的 CPU 和内存在普通用户计算机的范围内分配，没有任何专用硬件（如 GPU 或 ASIC）的支持，并且相同的约束应用于服务器虚拟机配置。我们为所有客户端和服务器配置了建立普通或加密连接的能力。特别是，加密客户端连接到支持两种类型的网络连接的矿池。</p>
<p>最后，我们提供了通过物理交换机中的端口镜像功能来捕获和复制穿越受控网络环境的所有网络流量的能力。通过这种方式，所有捕获的流量都可以被标记和存储以用于训练有监督的机器学习模型或直接用于测试目的。收集的数据包使用众所周知的 5 元组分组为流：IP 目标、IP 源、端口目标、端口源和传输协议。在机器学习模型的训练阶段，每次新数据包到达时，都会生成一组流统计信息（特征）并与数据集中的相应标签一起存储，用于训练或测试目的。在生产环境中，特征从流中提取并输入到先前训练的机器学习模型中，以概率值的形式预测流类型（例如加密或正常流）。</p>
<h2 id="六、机器学习模型"><a href="#六、机器学习模型" class="headerlink" title="六、机器学习模型"></a>六、机器学习模型</h2><p>为了找到性能最佳的模型，我们考虑了不同的监督机器和深度学习分类器，以利用它们各自的特定特征。鉴于我们不假设要输入到模型的特征之间的时间或空间关系，我们决定使用基于全连接神经网络 (FCNN) 的深度学习架构。此外，我们还考虑了其他几种著名的机器学习算法，例如逻辑回归模型 [18]、[19]、分类和回归决策树（CART [20] 和 C4.5 [21]）和随机森林 [22] ]。</p>
<p>Logistic 回归模型本质上是一种分类算法，它允许对仅具有两个可能值之一的二元结果进行建模。有几项工作建议将该技术应用于基于协议的 Internet 流量分类（[23]、[24]）。</p>
<p>分类和回归树 (CART) [20] 和 C4.5 算法 [21] 是决策树模型，能够根据从离散和连续特征推断出的规则树将数据分类为不同的类别。这些模型允许根据树的结果叶子的概率对输入特征向量进行分类，给出属于特定类别的概率。</p>
<p>随机森林 (RF) 模型 [22] 结合了几个决策树（特别是 CART 树），通过引导程序聚合（装袋）和每棵树的随机选择特征，使用多数投票过程产生更准确的分类。 RF 模型因其非线性分类能力、效率和鲁棒性而被广泛使用（[25]、[26]）。</p>
<p>全连接神经网络 (FCNN) 模型 [27]、[28]，也称为多层感知器，是一种前馈神经网络，它将节点组织成层，加权连接从一层到下一层前馈。输入向量从输入层通过隐藏层向输出层传播，以便将输入映射到输出向量。 FCNN 模型已成功用于从大量数据中识别复杂模式的广泛问题和领域。特别是在 [29] 中，它被用来检测网络流量上的 DDoS 攻击。</p>
<h2 id="七、-我们的方法"><a href="#七、-我们的方法" class="headerlink" title="七、 我们的方法"></a>七、 我们的方法</h2><p>我们的目标是将加密挖矿流量与常规互联网流量区分开来，后者是由网络连接、电子邮件传输、流媒体视频、云服务之间的数据传输等组成的各种流。 为了实现这一目标，我们使用<strong>图 3</strong> 中描述的工作流程来生成合适的数据集并训练一组机器和深度学习模型。</p>
<p>任何基于机器学习的过程的第一步都是生成高质量的数据集。我们使用 Mouseworld [30]，一个基于 NFV 的受控基础设施，在其上设置和部署加密攻击场景，该场景将产生我们的实验流量。我们安装了一系列虚拟机，一些矿工连接到互联网来产生加密和非加密的 Stratum 流，并使用各种其他方法来收集常规流量<br>（例如 HTTP/HTTPS 流、多媒体流）。 TCP 流由流量分析工具 Tstat 的修改版本捕获和分析，以便实时提取从多个连接统计数据中提取的一组特征，这些特征用作我们机器学习模型的输入特征。然后，我们在一个名为 Tagger 的特殊 Mouseworld 内部组件中添加了一个临时代码，以自动为每个 TCP 流实例分配一个二进制标签（0：正常流量连接，1：加密连接）。被标记后，我们使用这些样本来训练和测试各种机器学习模型。然而，在实际模型训练之前，我们执行特征选择阶段以提高模型的准确性，并执行超参数优化步骤以搜索最佳模型配置。为了验证我们的模型的质量，我们使用了与图 3 中描述的方法类似的方法，通过使用 Mouseworld 作为我们的网络基础设施，以便根据需要多次生成各种新的和现实的流量样本，以进行分类我们的机器学习模型。值得注意的是，ML 模型训练是在单独的环境中完成的，在该环境中，可以使用专门的 GPU 卡来加速深度神经网络的训练过程。</p>
<p>以下段落更详细地描述了我们如何构建数据集以及我们如何训练我们的模型，而第 VIII 节包含我们的实验结果。</p>
<h3 id="A-数据集创建"><a href="#A-数据集创建" class="headerlink" title="A. 数据集创建"></a>A. 数据集创建</h3><p>如前所述，我们网络基础设施的基础是 Mouseworld 实验室，这是一个在 Telefonica 研发场所设置的受控环境，用于运行实验，允许以受控方式部署复杂的网络场景并生成真实的标记数据集，用于训练受监督的 ML 组件并验证有监督和无监督的解决方案。 Mouseworld Lab 提供了一种启动客户端和服务器的方法，即使它们在 Internet 上与 Mouseworld 之外的客户端和服务器交互，也可以收集它们产生的流量，并最终在没有操作员干预的情况下为该流量添加标签。该环境部署在支持 NFV 的架构上，在协调器 (NFVO) 的管理下，根据需要扩展 ETSI NFV MANO 堆栈。</p>
<p>图 4 显示了 Mouseworld Lab 的详细图片，该实验室由在管道中交互的四个模块组成：启动器、数据收集器、特征提取器和标记器。 </p>
<p>Launcher 协调 Mouseworld 环境并运行实验，以生成不仅跨越 Mouseworld 内部网络而且跨越 Internet 的真实网络流量。该组件允许通过运行安装在一批 Linux 虚拟机中的真实客户端来产生三种基本类型的常规流量：网络、视频和文件托管（例如 Dropbox、OwnCloud）。此外，Launcher 还可以管理临时虚拟机，例如我们在研究工作中设置的包含 Monero 矿工的虚拟机，它还可以运行会话以使用 Ixia Breakingpoint 生成一组互补 Internet 协议的网络流量，一种商业工具，可以生成复杂的合成流量模式。</p>
<p>数据收集器模块收集单个实验生成的所有数据包。特征提取模块根据源和目的IP地址/端口号和传输协议的经典五元组将收集到的数据包分组为流，并调用外部模块获取每个流的特征集。在我们的实验中，我们使用了 Tstat 工具的修改版本，以便从流统计中得出一组标准 Netflow 功能以及我们对一组高信息功能的建议。修改后的 Tstat 不仅像在原始 Tstat 中那样在连接结束时以取证模式获取流特征，而且在不同的时刻实时获取流特征，这使我们能够训练和测试机器学习组件，即使只传输了流的几个数据包，也能识别加密流。</p>
<p>最后，Tagger 在每个实验执行期间使用 Launcher 输出的外部和日志信息自动为每个流添加标签，无需人工干预。由于流标记高度依赖于机器学习任务，因此该组件只是必须为每种类型的场景开发的 ad-hoc 标记器的简单包装。在我们的实验中，我们使用矿工（客户端）和加密服务器池的 IP 地址和端口对该组件进行了编码，以便将加密流与包含正常流量的其余流区分开来。请注意，标签仅用于训练和测试机器学习模型，当它们在生产环境中运行时不需要标签来生成预测。</p>
<p>Mouseworld 中部署的基础设施和配置如下所述。我们部署了 30 个虚拟机来生成常规流量（即 Web、视频和共享文件夹流）。 Web 和视频请求是使用 Chrome 无头浏览器生成的，共享文件夹（即文件托管）请求是使用 Dropbox 和 OwnCloud 的特定客户端生成的。使用指定了每种类型请求频率的配置文件，从客户端随机生成 Web、视频和共享文件夹请求。这些请求被随机发送到内部 Mouseworld 服务器和位于 Internet 上的外部服务器。值得注意的是，所有服务都生成了加密（例如 HTTPS 请求）和非加密（例如 HTTP 请求）流量请求。此外，IXIA BreakingPoint 工具还被配置为生成和注入各种 Internet 网络服务（Web、多媒体、共享文件夹、电子邮件和 P2P）的合成模式。 BreakingPoint 生成的流量也被配置为由加密和非加密流组成。</p>
<p>此外，我们还创建了三个加密挖掘 Linux 虚拟机。我们在所有三个虚拟机中都安装了 xmr-stak [31] 和 xmrig [32]，并将它们配置为使用加密和非加密的 Stratum 连接。我们使用所有这些客户端来挖掘 Monero [33] (XMR) 加密货币，通常用于非法目的 [6]。加密客户端使用默认设置通过非加密 TCP 和加密 TLS 连接与公共矿池连接。每个矿工每小时被强制断开连接并重新连接，以模拟新的矿池连接。</p>
<p>我们设计了四个实验，将 Launcher 和 BreakingPoint 工具与不同的加密客户端和协议相结合。每个实验运行一小时，平均数据包速率约为每秒 1000 个数据包，生成数据集，其中包含 800 万个 TCP 流，其中 4000 个与 Stratum 相关。特别是：</p>
<ul>
<li><p>在实验 1 中，BreakingPoint 工具与两个使用 TLS 加密连接的 xmr-stak 客户端和一个仅建立非加密 TCP 连接的 xmrig 客户端一起运行。</p>
</li>
<li><p>在实验 2 中，运行在 Mouseworld 虚拟机中的真实客户端启动以与位于 Internet 和 Mouseworld 内部网络中的服务器进行交互； 此外还部署了一个使用 TLS 加密连接的 xmr-stak 客户端和两个使用非加密 TCP 连接的 xmrig 客户端；</p>
</li>
<li><p>在实验 3 中，启动了真实客户端与两个使用 TLS 加密连接的 xmr-stak 客户端和一个仅建立非加密 TCP 连接的 xmrig 客户端的组合。</p>
</li>
<li><p>最后，在实验 4 中，BreakingPoint 工具与一个使用 TLS 加密连接的 xmr-stak 客户端和两个使用非加密流的 xmrig 客户端一起运行。</p>
</li>
</ul>
<p>为训练和测试目的，将获得的四个数据集分成两个独立的子集。具体来说，将实验 1 和 4 的数据集加入 DS1（训练）数据集，并将实验 2 和 3 中收集的其他两个数据集合并到 DS2（测试）数据集。通过这种方式，可以认为 DS1 和 DS2 具有相同的性质，因为它们包含相似百分比的加密和非加密流量、互联网服务类型和加密挖掘协议流。值得注意的是，挖矿协议产生的流量与正常流量相比较小，在所有数据集中都会出现挖矿流量与正常流量的不平衡（1：5000），这带来了额外的挑战用于训练 ML 分类器。<br>DS1 数据集（1600 万个示例）被打乱并分成两组，用于超参数优化的训练 (85%) 和验证 (15%)。 DS2 数据集（1600 万个示例）仅用于最终测试目的。</p>
<h3 id="B-模型训练"><a href="#B-模型训练" class="headerlink" title="B. 模型训练"></a>B. 模型训练</h3><p>对于我们的每个数据集，正确训练和测试 ML 模型的第一步是特征选择阶段。传统上，流量分类技术的深度数据包检测技术通过端口号检测或数据包有效载荷内容的解释来获取特征。然而，由于普遍使用加密方法来封装数据包内容（包括 TCP 或 UDP 端口号）以及政府越来越多地引入隐私法规以限制对数据包有效载荷数据的访问，这些技术往往受到越来越多的限制。为了克服这些限制，最近的机器和深度学习技术使用流描述作为机器学习模型的输入。这些描述由一组特征组成，这些特征是从外部可观察的流量属性获得的统计数据，例如每个流的持续时间和流量、数据包间到达时间、数据包大小和字节配置文件 [34]。</p>
<p>选择信息丰富的判别特征是在不同任务（如分类）中有效机器学习算法的关键步骤。特别是，机器学习分类器的性能不仅取决于模型之间的差异及其具体配置，还取决于输入特征的选择。如今，研究和工业界对一套可靠的功能没有达成强烈的共识，这些功能可以在所有场景中与机器学习一起表现良好。尽管如此，基于基于时间的统计特征（例如流的数据包的大小和数据包间时间，或数据包标头或有效载荷中字节分布的熵）的提议正在获得动力（[35]，[36]）。</p>
<p>在过去几年中，网络流量分析正面临与新的、更复杂和未知的流量入侵相关的新挑战。特别是，要确定一组足够的特征来帮助获得稳定且高性能的机器学习模型以用于新场景（例如加密矿流检测）并不容易。出于这个原因，我们决定比较两组不同的特征，目的是确定它们对机器学习性能的影响，并证明使用更多信息特征，可以获得机器学习性能的显着提高。两组特征都不是专门为加密攻击量身定制的，因为它们反映了网络流的参数，因此它们可以用于其他网络流量场景（例如网络流量分类）。由于我们的目标是检测网络上的加密攻击，因此使用流特征进行流（例如 TCP 连接）识别似乎是合适的方法。第一组 51 个特征被提议作为我们工作的一个新贡献，并且来自 Tstat 工具统计数据的一个子集。这些特征的集合在表 1 中有详细说明，其中 CS 代表客户端到服务器和 SC 服务器-到客户端的流量。 Tstat 工具 [37] 允许从传输层和应用层提取大量分类统计信息，并且不是为任何特定类型的网络流量或应用程序量身定制的</p>
<p>考虑到不检查数据包有效载荷的初始假设，我们不会使用 IP 地址或端口号或从应用层数据的统计数据得出的特征。此外，为了推导出这组特征，我们使用以下标准选择了 Tstat 统计数据：首先，我们没有考虑 Tstat 统计数据在不同时刻显示所有连接的恒定值，因为它们不包含任何信息（例如 c_rst_cnt、s_rst_cnt、c_isint、s_isint）。其次，我们对数据应用线性相关分析，以识别和删除高度相关的变量。在这种情况下，我们在使用此标准丢弃 Tstat 统计数据时采用了相当保守的方法，因为相关性分析仅显示变量之间的线性相关性，而神经网络往往会发现变量之间有趣的非线性关系。因此，我们没有使用此标准删除任何 Tstat 统计数据，以便为所有机器学习模型，特别是神经网络模型提供机会发现特征之间的非线性关系。最后，我们应用我们之前在网络和协议方面的专业知识来丢弃对机器学习应用无益的 Tstat 统计信息。特别是net_dup（网络数据包重复次数）、reordering（观察到的数据包重新排序次数）、rtx_RTO（由于超时到期重传的段数）和rtx_FR（由于快速重传而重传的段数，三个dup- ack）等被删除，因为它们代表了特定时间段内出现的网络流量拥塞情况的统计数据，而其他时间可能不会出现。    </p>
<p>此外，作为双重检查机制，我们在使用随机森林模型训练模型后获得特征重要性值，我们观察到几乎所有特征的值范围为 0.12 到 0.01，除了 s_tm_opt（服务器发送的时间戳选项）显示一个非常小的值 0.0000184。这个结果强调没有任何特征子集比其他特征更重要，相反，所有选定的 Tstat 派生特征都有助于复杂模型的高性能。值得注意的是，当使用深度神经网络时，特征重要性不能那么容易获得，因此，推荐的方法是将所有输入特征提供给神经网络，让优化算法自己找到哪些特征信息量最大.关于神经网络决策的可解释性和可解释性及其与输入特征的关系是目前正在研究的主题，我们决定保留初始 51 个 Tstat 派生特征作为所有机器学习模型的输入，以便在相同的条件。</p>
<p>第二组功能将源自 IETF 标准 NetFlow/IPFIX 指标。最近在 [7] 中提出了这组八个特征，用于使用机器学习检测加密挖掘活动。这些派生特征是：</p>
<ul>
<li>入站和出站数据包/秒；</li>
<li>入站和出站比特/秒；</li>
<li>入站和出站位/数据包；</li>
<li>比特入站/比特出站比率；</li>
<li>数据包入站/数据包出站比率。</li>
</ul>
<p>因此，我们用三组特征评估了我们的机器学习模型：</p>
<ul>
<li>在场景A 中，使用了NetFlow/IPFIX 指标；</li>
<li>在场景 B 中，仅使用了从 Tstat 统计得出的特征；</li>
<li>最后，在场景 C 中，Tstat 派生和 NetFlow/IPFIX 功能共同使用。</li>
</ul>
<p>在特征选择阶段之后，我们执行超参数优化阶段，以找到最佳超参数以实现高度准确的模型。优化超参数被认为是构建机器学习模型中最棘手的部分之一，因为在构建模型时通过简单地猜测和测试这些值的几种组合几乎不可能获得最佳参数。另一方面，尝试一组超参数的所有值组合是不可扩展的，因为要测试的组合数量随着超参数的数量和每个超参数中要测试的值的范围呈指数增长。有几种启发式方法可以帮助找到这些最佳超参数，随机搜索是最流行和最有效的方法之一。顾名思义，评估的超参数组合是从超参数多维网格中随机选择的。</p>
<p>随机搜索的基本策略包括评估每个超参数值组合的验证分数，并将结果与超参数组合一起记录。在搜索结束时，选择产生最高验证分数的超参数，并在所有训练数据集上训练模型。最后，使用该模型对测试数据集进行预测。每次运行随机搜索时，都将超参数空间用作输入，算法会生成超参数值的随机组合以供尝试。除了在超参数空间中的可用值中随机选择下一个值之外，对随机搜索没有任何要求。</p>
<p>在我们的实验中，我们使用随机搜索算法 (RS) 来寻找训练每个模型的超参数值的最佳组合。在对每个模型进行了大量训练并使用了足够多的超参数组合后，我们选择了验证时 F1 分数最高的模型。每个机器学习模型至少使用了几十种不同的组合。在观察到搜索结果稳定后停止随机搜索（即在几次随机搜索迭代后没有出现更好的模型）表 2 显示了我们为每个模型优化的范围和超参数。</p>
<p>在运行随机搜索之前，我们对基于全连接神经网络 (FCNN) 架构的不同深度学习模型进行了一些初步评估。我们使用前向旁路连接和批量归一化在 FCNN 中使用多达 10 个隐藏层运行这些初步评估，以避免梯度消失。据观察，使用大量层（例如 8 到 10）并没有产生比我们使用较少层（2 到 4）训练 FCNN 时更好的值。因此，在随机搜索过程中，我们将 FCNN 层的搜索范围从 1 层减少到 5 层。因此，我们训练并测试了浅（1-2 个隐藏层）和深（3-5 个隐藏层）全连接神经网络</p>
<p>请注意，类权重超参数的定义是为了管理加密挖掘用例上下文中数据集的不平衡性质。如前所述，正常连接与加密挖掘连接的比率约为 5,000，这对训练过程的最终结果产生负面影响。因此，在 FCNN 模型的训练过程中尝试了该参数的不同值，以调节优化算法的行为。随机森林和逻辑回归是使用 Scikit-learn 库实现进行训练的，其中 classweigth 参数试图解决这个问题。此外，FCNN 模型使用整流线性单元 (ReLU) 作为激活函数，因此没有对该参数进行超参数搜索。</p>
<h2 id="八。实验结果"><a href="#八。实验结果" class="headerlink" title="八。实验结果"></a>八。实验结果</h2><p>我们进行了一组实验，以评估多种机器和深度学习模型检测加密货币流并将其与正常流量连接区分开来的性能。在实验开始时定义了两个互补的目标。首先，为了证明复杂的机器学习模型（例如深度神经网络）比简单的模型表现更好，其次，为了表明与之前的特征相比，我们提出的 Tstat 特征集（表 1）显着提高了这些模型的性能提案。作为更简单模型的代表，我们选择了 [7] 中提出的 ML 模型（SVM、朴素贝叶斯和 CART 以及 C4.5 树），目的是在更现实的场景中将它们的结果与复杂的深度学习模型进行比较，如部署在我们的实验。此外，选择随机森林是因为它被广泛认为是性能最好的 ML 技术之一，而逻辑回归是一种极其简单的方法的代表。在接下来的段落中，我们将描述通过使用第 VII 节中详述的数据集创建和模型训练程序获得的结果。</p>
<h3 id="A-机器学习设置"><a href="#A-机器学习设置" class="headerlink" title="A. 机器学习设置"></a>A. 机器学习设置</h3><p>我们的目标问题旨在预测加密矿流并将它们与其他网络流区分开来。因此，这个问题被建模为一个分类器，其中预期输出是一个二进制值：1 对应于分类器识别的加密连接，而 0 分配给其余的连接。</p>
<p>为了能够准确地对这两种类型的连接进行分类，我们基于先前在第六节中介绍的分类器训练和测试机器深度学习分类器。特别是，我们评估了全连接神经网络 (FCNN) 并与传统机器学习技术进行了比较，例如逻辑回归 (LR)、CART 和 C4.5 决策树 (CART, C4.5) 和随机森林 (RF)。值得注意的是，在初步实验中，我们将 SVM 和朴素贝叶斯分类器包含在要评估的机器学习技术集中。然而，我们观察到，与 CART 和 C4.5 树相比，这两种技术都表现不佳。因此，朴素贝叶斯和 SVM 被排除在我们与其他模型的实验比较之外。此外，仅使用一小部分训练数据集（1600 万个示例的 1/100），SVM 训练时间就需要两天时间。从表 6 中可以看出，其余模型在最坏的情况下使用整个数据集（1600 万个示例）训练模型的时间不超过 40 分钟。</p>
<p>我们使用了第 VII-B 节中详述的训练程序，对于每个模型，应用了以下步骤：1）执行特征选择阶段； 2) 在超参数空间上运行随机搜索，并使用获得的超参数组合训练模型； 3) 在验证集上使用 F1-score 对性能最好的模型进行排名； 4）在测试（DS2）数据集上测试最佳模型。<br>为了在验证和测试中对获得的结果进行比较和排名，我们计算了一组广泛用于分类问题的质量指标（[38]，[39]）：准确率、宏观和微观版本的精度、召回率和 F1 分数和混淆矩阵。此外，计算了曲线下的 ROC 和 P-R 面积 (AUC)，并绘制了它们相应的曲线。这些指标使我们能够衡量我们的模型在一组异构互联网连接中识别和检测加密货币流的质量</p>
<p>使用著名的 scikit-learn 库中可用的 Python 代码版本训练传统机器学习模型（LR、CART 和 RF）。由于在 scikit-learn 库中没有可用的 C4.5 实现，我们使用了 Weka 工具 [40] 中包含的 C4.5 的 J48 版本。深度学习模型 (FCNN) 是在 Python 中使用 Keras 框架 [41] 在 Tensorflow [42] 上实现的，以利用 GPU 加速。所有神经网络都使用 Adam 优化器 [27] 进行训练，以最大限度地减少交叉熵损失。在这种情况下，训练过程由一系列训练迭代组成。每次训练迭代包括 5 个 epoch，在每次迭代结束时，F1 分数在验证集上计算并用作提前停止标准（即在 10 次迭代后验证指标没有增强，训练过程停止）。无论如何，训练在 500 次迭代后停止。另外请注意，在训练 FCNN 时，将少量训练数据 (15%) 留出并用于在训练过程中提前停止 epoch 数，从而避免过度拟合和局部最小停滞。</p>
<h3 id="B-模型的结果和比较分析"><a href="#B-模型的结果和比较分析" class="headerlink" title="B. 模型的结果和比较分析"></a>B. 模型的结果和比较分析</h3><p>使用之前描述的随机搜索程序和 DS1 数据集，我们针对每个场景 A、B 和 C 训练和验证了 LR、CART、C4.5 和 RF 的 15 个模型组合以及 FCNN 的 74 个模型组合。让神经网络模型有更多的超参数 ，需要更多的超参数组合才能找到大量具有良好性能的模型。</p>
<p>方案 A、B 和 C 获得的结果分别显示在表 3、4 和 5 中。 在这些表中，每一列都显示了测试数据集 (DS2) 上每个模型（FCNN、RF、CART、C4.5 和 LR）的最佳代表的测试结果。 使用它们在验证数据集中的排名结果在所有模型组合中选择每个模型的最佳代表。 每个模型的代表都通过其超参数的摘要进行标识，包括架构细节，使用紧凑符号进行描述，如下例所示：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">#1/75 FCNN</span><br><span class="line">[722, 847, 710]</span><br><span class="line">0.001500, 0.000002</span><br><span class="line">0.000012, 2;</span><br><span class="line">F1 (macro) 0.9886)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>应用的命名法如下：<br>应用的命名法如下：<br>•（第一行）#X/YmodelName：X 和Y 分别表示模型在测试排名中的位置和训练的模型组合总数。 回想一下，表格中显示的模型始终是验证的最佳模型。 因此，接近 1 的数字 X 表示在验证阶段获得良好性能的模型在使用不同的 DS2 数据集进行测试时表现一致。 因此，如果模型在验证的顶级模型中选择，我们可以对模型组合在实时生产场景中的性能充满信心。</p>
<p>• FCNN 模型添加以下值：<br>–（第 2 行）描述神经网络架构的值列表：[X0, X1, . . . , 习, . . . , Xn] 其中 n 是层数，Xi 是层 i 中的单元数。<br>–（第 3 行和第 4 行）Dropout、L2 正则化值、Adam 学习率和类权重值（即加密流类相对于表 2 中定义的正常流量类的权重）。</p>
<p>• 随机森林模型包括：<br>– 树木的数量<br>– 树木的最大深度限制。<br>• Logistic 回归模型显示应用的正则化系数。<br>• CART 模型指示树木的最大深度。<br>• C4.5 模型包括置信值 (C) 和两个最流行分支中的最小实例数 (M)。<br>• （最后一行）所有模型都显示了在验证中获得的 F1 分数（宏观）值。</p>
<p>表 3、4 和 5 显示了每个模型在测试数据集上计算的质量指标。 F1-score、Precision 和 Recall 宏值与 Accuracy、RoC 和 P-R 曲线下面积（AUC ROC 和 AUC P-R）一起呈现。 最后一行显示了混淆矩阵，其中 cyptomining 连接的值被分解为两个数字，以便更好地分析。 SSL值代表数字<br>加密的加密流和 NoSSL 代表未加密的流。</p>
<p>从全局来看，可以观察到：a) 复杂模型——深度神经网络（FCNN）、随机森林和 C4.5——在所有场景中都比简单的策略——CART 和 LR——获得更好的结果； b) 在场景 B 中获得了最好的结果，它建议利用 Tstat 特征作为机器学习模型的输入。 此外，结合使用 Tstat 和 NetFlow 功能的场景 C，与仅使用 Tstat 功能（场景 B）相比，没有获得任何可观察到的优势。</p>

    </div>

    
    
    

      <footer class="post-footer">

        


        
    <div class="post-nav">
      <div class="post-nav-item">
    <a href="/post/sth-on-ngin/" rel="prev" title="Something on NGIN: 一些隨筆">
      <i class="fa fa-chevron-left"></i> Something on NGIN: 一些隨筆
    </a></div>
      <div class="post-nav-item">
    <a href="/post/how-xmr-pick-fake-inputs/" rel="next" title="how-xmr-pick-fake-inputs">
      how-xmr-pick-fake-inputs <i class="fa fa-chevron-right"></i>
    </a></div>
    </div>
      </footer>
    
  </article>
  
  
  



          </div>
          
    <div class="comments" id="gitalk-container"></div>

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          Table of Contents
        </li>
        <li class="sidebar-nav-overview">
          Overview
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
          <div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#%E4%BD%BF%E7%94%A8%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0%E4%B8%8E%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0%E5%AF%B9%E6%81%B6%E6%84%8F%E5%8A%A0%E5%AF%86%E8%B4%A7%E5%B8%81%E6%8C%96%E7%9F%BF%E8%BD%AF%E4%BB%B6%E5%8A%A0%E5%AF%86%E8%BF%9E%E6%8E%A5%E7%9A%84%E6%A3%80%E6%B5%8B"><span class="nav-number">1.</span> <span class="nav-text">使用机器学习与深度学习对恶意加密货币挖矿软件加密连接的检测</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E4%B8%80%E3%80%81%E5%BC%95%E8%A8%80"><span class="nav-number">1.1.</span> <span class="nav-text">一、引言</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E4%BA%8C%E3%80%81%E8%B4%A1%E7%8C%AE"><span class="nav-number">1.2.</span> <span class="nav-text">二、贡献</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E4%B8%89%E3%80%81%E5%8A%A0%E5%AF%86%E8%B4%A7%E5%B8%81%E5%92%8C%E5%8A%A0%E5%AF%86%E6%8C%96%E6%8E%98%E5%8D%8F%E8%AE%AE"><span class="nav-number">1.3.</span> <span class="nav-text">三、加密货币和加密挖掘协议</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%9B%9B%E3%80%81-%E7%9B%B8%E5%85%B3%E5%B7%A5%E4%BD%9C"><span class="nav-number">1.4.</span> <span class="nav-text">四、 相关工作</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#A-%E5%8A%A0%E5%AF%86%E6%B5%81%E9%87%8F%E7%9A%84%E8%AF%86%E5%88%AB"><span class="nav-number">1.4.1.</span> <span class="nav-text">A. 加密流量的识别</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#B-%E5%8A%A0%E5%AF%86%E8%BD%AF%E4%BB%B6%E6%A8%A1%E5%9D%97%E7%9A%84%E8%AF%86%E5%88%AB"><span class="nav-number">1.4.2.</span> <span class="nav-text">B. 加密软件模块的识别</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E4%BA%94%E3%80%81%E9%97%AE%E9%A2%98%E8%AE%BE%E5%AE%9A"><span class="nav-number">1.5.</span> <span class="nav-text">五、问题设定</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%85%AD%E3%80%81%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0%E6%A8%A1%E5%9E%8B"><span class="nav-number">1.6.</span> <span class="nav-text">六、机器学习模型</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E4%B8%83%E3%80%81-%E6%88%91%E4%BB%AC%E7%9A%84%E6%96%B9%E6%B3%95"><span class="nav-number">1.7.</span> <span class="nav-text">七、 我们的方法</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#A-%E6%95%B0%E6%8D%AE%E9%9B%86%E5%88%9B%E5%BB%BA"><span class="nav-number">1.7.1.</span> <span class="nav-text">A. 数据集创建</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#B-%E6%A8%A1%E5%9E%8B%E8%AE%AD%E7%BB%83"><span class="nav-number">1.7.2.</span> <span class="nav-text">B. 模型训练</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%85%AB%E3%80%82%E5%AE%9E%E9%AA%8C%E7%BB%93%E6%9E%9C"><span class="nav-number">1.8.</span> <span class="nav-text">八。实验结果</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#A-%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0%E8%AE%BE%E7%BD%AE"><span class="nav-number">1.8.1.</span> <span class="nav-text">A. 机器学习设置</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#B-%E6%A8%A1%E5%9E%8B%E7%9A%84%E7%BB%93%E6%9E%9C%E5%92%8C%E6%AF%94%E8%BE%83%E5%88%86%E6%9E%90"><span class="nav-number">1.8.2.</span> <span class="nav-text">B. 模型的结果和比较分析</span></a></li></ol></li></ol></li></ol></div>
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name">Command M (C0MM4ND/K0MM4ND)</p>
  <div class="site-description" itemprop="description"></div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">55</span>
          <span class="site-state-item-name">posts</span>
        </a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
          
        <span class="site-state-item-count">64</span>
        <span class="site-state-item-name">tags</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author motion-element">
      <span class="links-of-author-item">
        <a href="https://github.com/c0mm4nd" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;c0mm4nd" rel="noopener" target="_blank"><i class="fab fa-github fa-fw"></i>GitHub</a>
      </span>
      <span class="links-of-author-item">
        <a href="mailto:maoxs2#gmail.com" title="E-Mail → mailto:maoxs2#gmail.com" rel="noopener" target="_blank"><i class="fa fa-envelope fa-fw"></i>E-Mail</a>
      </span>
      <span class="links-of-author-item">
        <a href="https://twitter.com/k0mm4nd" title="Twitter → https:&#x2F;&#x2F;twitter.com&#x2F;k0mm4nd" rel="noopener" target="_blank"><i class="fab fa-twitter fa-fw"></i>Twitter</a>
      </span>
  </div>


  <div class="links-of-blogroll motion-element">
    <div class="links-of-blogroll-title"><i class="fa fa-link fa-fw"></i>
      Links
    </div>
    <ul class="links-of-blogroll-list">
        <li class="links-of-blogroll-item">
          <a href="https://ngin.sh/" title="https:&#x2F;&#x2F;NGIN.sh" rel="noopener" target="_blank">NGIN</a>
        </li>
    </ul>
  </div>

      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2021</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Command M (C0MM4ND/K0MM4ND)</span>
</div>
  <div class="powered-by">Powered by <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://muse.theme-next.org/" class="theme-link" rel="noopener" target="_blank">NexT.Muse</a>
  </div>

        








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/muse.js"></script>


<script src="/js/next-boot.js"></script>

<script src="/js/bookmark.js"></script>




  




  
<script src="/js/local-search.js"></script>









<script>
document.querySelectorAll('.pdfobject-container').forEach(element => {
  let url = element.dataset.target;
  let pdfOpenParams = {
    navpanes : 0,
    toolbar  : 0,
    statusbar: 0,
    pagemode : 'thumbs',
    view     : 'FitH'
  };
  let pdfOpenFragment = '#' + Object.entries(pdfOpenParams).map(([key, value]) => `${key}=${encodeURIComponent(value)}`).join('&');
  let fullURL = `/lib/pdf/web/viewer.html?file=${encodeURIComponent(url)}${pdfOpenFragment}`;

  if (NexT.utils.supportsPDFs()) {
    element.innerHTML = `<embed class="pdfobject" src="${url + pdfOpenFragment}" type="application/pdf" style="height: ${element.dataset.height};">`;
  } else {
    element.innerHTML = `<iframe src="${fullURL}" style="height: ${element.dataset.height};" frameborder="0"></iframe>`;
  }
});
</script>


<script>
if (document.querySelectorAll('pre.mermaid').length) {
  NexT.utils.getScript('//cdn.jsdelivr.net/npm/mermaid@latest/dist/mermaid.min.js', () => {
    mermaid.initialize({
      theme    : 'forest',
      logLevel : 3,
      flowchart: { curve     : 'linear' },
      gantt    : { axisFormat: '%m/%d/%Y' },
      sequence : { actorMargin: 50 }
    });
  }, window.mermaid);
}
</script>


  

<script>
  if (typeof MathJax === 'undefined') {
    window.MathJax = {
      loader: {
        source: {
          '[tex]/amsCd': '[tex]/amscd',
          '[tex]/AMScd': '[tex]/amscd'
        }
      },
      tex: {
        inlineMath: {'[+]': [['$', '$']]},
        tags: 'ams'
      },
      options: {
        renderActions: {
          findScript: [10, doc => {
            document.querySelectorAll('script[type^="math/tex"]').forEach(node => {
              const display = !!node.type.match(/; *mode=display/);
              const math = new doc.options.MathItem(node.textContent, doc.inputJax[0], display);
              const text = document.createTextNode('');
              node.parentNode.replaceChild(text, node);
              math.start = {node: text, delim: '', n: 0};
              math.end = {node: text, delim: '', n: 0};
              doc.math.push(math);
            });
          }, '', false],
          insertedScript: [200, () => {
            document.querySelectorAll('mjx-container').forEach(node => {
              let target = node.parentNode;
              if (target.nodeName.toLowerCase() === 'li') {
                target.parentNode.classList.add('has-jax');
              }
            });
          }, '', false]
        }
      }
    };
    (function () {
      var script = document.createElement('script');
      script.src = '//cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js';
      script.defer = true;
      document.head.appendChild(script);
    })();
  } else {
    MathJax.startup.document.state(0);
    MathJax.texReset();
    MathJax.typeset();
  }
</script>

  

<link rel="stylesheet" href="//cdn.jsdelivr.net/npm/gitalk@1/dist/gitalk.min.css">

<script>
NexT.utils.loadComments(document.querySelector('#gitalk-container'), () => {
  NexT.utils.getScript('//cdn.jsdelivr.net/npm/gitalk@1/dist/gitalk.min.js', () => {
    var gitalk = new Gitalk({
      clientID    : '06edfa751f3d44529e6d',
      clientSecret: 'e6469fb76c0061cfe1b084ee807d140e100a4c51',
      repo        : 'c0mm4nd.com',
      owner       : 'C0MM4ND',
      admin       : ['C0MM4ND'],
      id          : 'fcb2b36223dde695cb8c4cbfdbec0e88',
        language: '',
      distractionFreeMode: true
    });
    gitalk.render('gitalk-container');
  }, window.Gitalk);
});
</script>

</body>
</html>
